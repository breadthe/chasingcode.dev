<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="description" content="Documenting my workflow for dealing with forked PHP packages">

            <meta property="og:title" content="My PHP Forked Package Workflow" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://chasingcode.dev/blog/php-forked-package-workflow"/>
    <meta property="og:description" content="Documenting my workflow for dealing with forked PHP packages" />

        
        <title>My PHP Forked Package Workflow | Chasing Code</title>

        <link rel="home" href="https://chasingcode.dev">

        <link rel="apple-touch-icon" sizes="57x57" href="/assets/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/assets/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/assets/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/assets/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/assets/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/assets/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/assets/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/assets/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/assets/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/favicons/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/assets/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

        <link href="/blog/feed.atom" type="application/atom+xml" rel="alternate" title="Chasing Code Blog">

        

        <link rel="stylesheet" href="/assets/build/css/main.css?id=3824d15a7550cadd6feea53f638e89ad">
        <link href="https://github.com/breadthe" rel="me">
        <link rel="webmention" href="https://webmention.io/chasingcode.dev/webmention" />
        <link rel="pingback" href="https://webmention.io/chasingcode.dev/xmlrpc" />
    </head>

    <body class="flex flex-col justify-between bg-gray-50 text-grey-darkest leading-normal font-sans">

        <header class="flex items-center py-4" role="banner">
    <div class="container flex items-center max-w-6xl mx-auto px-4 lg:px-8">
        <div class="flex items-center">
            <a href="/" title="Chasing Code home" class="flex items-center justify-center gap-2 mr-2">
                <img width="48" height="48" src="/assets/images/chasingcode-logo.png" alt="Chasing Code logo" />

                <span class="text-xl leading-none font-bold text-teal-700">Chasing Code</span>
            </a>
        </div>

        <div id="vue-search" class="w-full flex justify-end items-center sm:gap-4">
                            <search
                    data-belongs-to-blog="1"
                ></search>
            
            <nav class="hidden sm:flex items-center justify-end gap-8 text-lg">
    <ul class="flex gap-4">
        <li>
    <a
        href=/blog
        class="text-teal-700 hover:text-teal-900 text-teal-900 underline underline-offset-4 decoration-4 decoration-teal-400"
    >Blog</a>
</li>

        <li>
    <a
        href=/archive
        class="text-teal-700 hover:text-teal-900"
    >Archive</a>
</li>

        <li>
    <a
        href=/games
        class="text-teal-700 hover:text-teal-900"
    >Games</a>
</li>

        <li>
    <a
        href=/uses
        class="text-teal-700 hover:text-teal-900"
    >Uses</a>
</li>

        <li>
    <a
        href=/about
        class="text-teal-700 hover:text-teal-900"
    >About</a>
</li>

        <li>
    <a
        href=/contact
        class="text-teal-700 hover:text-teal-900"
    >Contact</a>
</li>
    </ul>
</nav>

            <button class="flex justify-center items-center h-10 px-4 rounded-full sm:hidden focus:outline-none"
    onclick="navMenu.toggle()"
>
    <svg id="js-nav-menu-show" xmlns="http://www.w3.org/2000/svg"
        class="fill-current w-6 text-teal-400" viewBox="0 0 32 32"
    >
        <path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z"/>
    </svg>

    <svg id="js-nav-menu-hide" xmlns="http://www.w3.org/2000/svg"
        class="hidden fill-current w-6 text-teal-400" viewBox="0 0 36 30"
    >
        <polygon points="32.8,4.4 28.6,0.2 18,10.8 7.4,0.2 3.2,4.4 13.8,15 3.2,25.6 7.4,29.8 18,19.2 28.6,29.8 32.8,25.6 22.2,15 "/>
    </svg>
</button>

        </div>
    </div>
</header>

<nav id="js-nav-menu" class="hidden sm:hidden mb-4">
    <ul class="my-0 flex flex-col gap-4 px-4">
        <li>
    <a
        href=/blog
        class="text-teal-700 hover:text-teal-900 text-teal-900 underline underline-offset-4 decoration-4 decoration-teal-400"
    >Blog</a>
</li>

        <li>
    <a
        href=/archive
        class="text-teal-700 hover:text-teal-900"
    >Archive</a>
</li>

        <li>
    <a
        href=/games
        class="text-teal-700 hover:text-teal-900"
    >Games</a>
</li>

        <li>
    <a
        href=/uses
        class="text-teal-700 hover:text-teal-900"
    >Uses</a>
</li>

        <li>
    <a
        href=/about
        class="text-teal-700 hover:text-teal-900"
    >About</a>
</li>

        <li>
    <a
        href=/contact
        class="text-teal-700 hover:text-teal-900"
    >Contact</a>
</li>
    </ul>
</nav>

        <main
            role="main"
            class="flex-auto w-full max-w-2xl mx-auto"
        >
            
                <article class="p-4 sm:p-6 bg-white rounded">
        <header class="mb-2">
            
            <h1 class="font-serif text-3xl mb-1 md:mb-2">My PHP Forked Package Workflow</h1>

            <div class="flex flex-col md:flex-row gap-2">
                <small class="font-mono">
                    by <a href="/about">webmaster</a>
                </small>

                <small class="hidden md:block">&bull;</small>

                <small class="font-mono">
                    2021-05-26
                </small>

                
                <small class="hidden md:block">&bull;</small>

                <small class="flex flex-wrap gap-2">
                    <a
        href="/blog/tags/php"
        title=" posts in View posts in #php"
        class="category--tag font-mono font-light text-teal-700"
        >
    #php
</a>
            </small>
            </div>

                    </header>

        <div class="post font-light text-gray-900 tracking-wide pb-4" v-pre>
            <p>Packages are great - they bring specific functionality out of the box, without the need to re-invent it yourself. The downside is that each additional package installed into an application creates one extra dependency. Eventually, one of these dependencies will lag behind, potentially causing your project to grind to a halt.</p>

<p>My personal preference is to keep dependencies at a minimum, for several reasons, but that's a rant for another time.</p>

<p>Here are a few ways in which 3rd party packages can cause headaches:</p>

<ul>
<li>the package stops being maintained</li>
<li>the author is slow to release new features or fix bugs</li>
<li>the package isn't updated in a timely manner for new language or framework versions</li>
</ul>

<p>When a dependency "breaks" for me, I typically do the following:</p>

<ul>
<li>fork the package</li>
<li>implement a fix</li>
<li>make a pull request to the original repository</li>
<li>while waiting for the PR to be merged (not always guaranteed), I'll switch to using the fork</li>
</ul>

<p>This will get me unstuck for the time being, but the ideal outcome is for my contribution to be accepted in the official package.</p>

<h2>Quick primer on PHP package management</h2>

<p>In PHP we use <code>composer</code> to manage packages (install, remove, update, etc). Dependencies are defined in the <code>composer.json</code> file.</p>

<p>To install a new package, we run the following command (actual example from one of my apps):</p>

<pre><code class="language-bash">composer require codetoad/strava
</code></pre>

<p>This creates an entry in <code>composer.json</code> like so:</p>

<pre><code class="language-json">...
    "require": {
        "php": "^8.0",
        "ext-json": "*",
        "codetoad/strava": "^1.0",
        ...
    },
...
</code></pre>

<p>Note that the official repository for this package is located at <a href="https://github.com/RichieMcMullen/laravel-strava">https://github.com/RichieMcMullen/laravel-strava</a>.</p>

<h2>Forking the original package</h2>

<p>Continuing on the previous example, I've been using the Laravel Strava package in one of my apps, and so far it's been great at pulling data <em>from</em> Strava's API. However, it does not have the ability to modify data.</p>

<p>I decided I wanted to update several parameters belonging to an Activity, such as name, description, and gear. Since I couldn't simply ask the author to implement this for me, I knew I had to do it myself.</p>

<p>The first step is to fork the package. In GitHub, simply click the Fork button in the top right corner, and it will create a copy of the repository under your own organization. For me, that would be <a href="https://github.com/breadthe/laravel-strava">https://github.com/breadthe/laravel-strava</a>.</p>

<h2>Clone the fork locally</h2>

<p>Now I want to work on the fork locally, so I simply clone it with <code>git clone https://github.com/breadthe/laravel-strava</code>, then implement the features I need.</p>

<h2>Linking the app to the local fork</h2>

<p>One of the cool things Composer lets you do is to link a package to a local directory. This can be done with a relative or absolute link.</p>

<p>I cloned the forked package in the following directory (Mac): <code>/Users/myuser/code/packages/php/laravel-strava</code>.</p>

<p>The app that requires the package is in <code>/Users/myuser/code/laravel/example-app</code>. Let's switch to it now, in the terminal. Then I'm going to remove the <code>codetoad/strava</code> package using Composer.</p>

<pre><code class="language-bash">cd /Users/myuser/code/laravel/example-app
composer remove codetoad/strava
</code></pre>

<p>Open up <code>composer.json</code> and add the following top-level key:</p>

<pre><code class="language-json">    "repositories": [
        {
            "type": "path",
            "url": "/Users/myuser/code/packages/php/laravel-strava"
        }
    ],
</code></pre>

<p>This tells Composer to install a package called <code>laravel-strava</code> from the local path. Alternatively, you can use a relative path such as <code>../../packages/php/laravel-strava</code>.</p>

<p>Finally install the package with a <code>@dev</code> constraint:</p>

<pre><code class="language-bash">composer require codetoad/strava @dev
</code></pre>

<p>You should see this in <code>composer.json</code>:</p>

<pre><code class="language-json">    "require": {
        "php": "^8.0",
        "ext-json": "*",
        "codetoad/strava": "@dev",
        ...
</code></pre>

<p>Now any changes made to the local fork will appear in the app.</p>

<h2>Linking the app to the remote fork</h2>

<p>Once local development on the fork is complete, I can push my changes to the remote fork. From there, I can create a pull request to the original package, and hope the changes will be accepted.</p>

<p>Meanwhile, there's no need to delay development, since I can simply link to my own fork.</p>

<p>To do this, once again remove the package:</p>

<pre><code class="language-bash">composer remove codetoad/strava
</code></pre>

<p>Then modify the <code>repositories</code> key in <code>composer.json</code> like so:</p>

<pre><code class="language-json">    "repositories": [
        {
            "type": "vcs",
            "url": "https://github.com/breadthe/laravel-strava"
        }
    ],
</code></pre>

<p>This tells Composer to install a package called <code>laravel-strava</code> from the Version Control System location specified in the URL (instead of the default repo for <code>codetoad/strava</code>).</p>

<p>Finally, install the package once more, with a <code>dev-master</code> constraint:</p>

<pre><code class="language-bash">composer require codetoad/strava dev-master
</code></pre>

<p>You should see this in <code>composer.json</code>:</p>

<pre><code class="language-json">    "require": {
        "php": "^8.0",
        "ext-json": "*",
        "codetoad/strava": "dev-master",
        ...
</code></pre>

<p>And that's it. The app can now be deployed to a production server, and running <code>composer install</code> will install the forked package.</p>

<h2>PR merged, now what?</h2>

<p>At the time of writing this, my PR hasn't yet been merged, but here's what I would do next:</p>

<ul>
<li>remove the package <code>composer remove codetoad/strava</code></li>
<li>remove the <code>repositories</code> key from <code>composer.json</code></li>
<li>(optional) delete the <code>vendor/</code> folder</li>
<li>run the original install command <code>composer require codetoad/strava</code></li>
</ul>

<h2>Conclusion</h2>

<p>This is simpler than it sounds, but I had to document it for my own benefit. I don't deal with forks often enough to have it committed to muscle memory, so writing it down will definitely help when I need it again. I hope it will be useful to you as well, and if I missed anything or you find any mistakes, let me know on <a href="https://twitter.com/brbcoding/">Twitter</a>.</p>

            <section class="mt-8">
    <div class="font-semibold">
        Liked this article? Share it on your favorite platform.
    </div>

    <div class="mt-2 flex flex-wrap gap-2">
        <a href="javascript:void(0);"
                id="mastodon-share"
                data-src="Documenting my workflow for dealing with forked PHP packages&amp;url=https://chasingcode.dev/blog/php-forked-package-workflow"
                class="bg-mastodon-purple social--share--icon no-underline text-white hover:text-white rounded font-mono px-2 py-1"
        >Mastodon</a>

        <a href="https://twitter.com/share?url=https://chasingcode.dev/blog/php-forked-package-workflow&text=Documenting my workflow for dealing with forked PHP packages&via=brbcoding"
           style="background: #55acee;"
           class="social--share--icon no-underline text-white hover:text-white rounded font-mono px-2 py-1"
        >Twitter</a>

        <a href="https://www.facebook.com/sharer/sharer.php?u=https://chasingcode.dev/blog/php-forked-package-workflow"
           style="background: #3B5998;"
           class="social--share--icon no-underline text-white hover:text-white rounded font-mono px-2 py-1"
        >Facebook</a>

        <a href="https://reddit.com/submit?url=https://chasingcode.dev/blog/php-forked-package-workflow&title=My PHP Forked Package Workflow"
           style="background: #ff5700;"
           class="social--share--icon no-underline text-white hover:text-white rounded font-mono px-2 py-1"
        >Reddit</a>

        <a href="https://news.ycombinator.com/submitlink?u=https://chasingcode.dev/blog/php-forked-package-workflow&t=My PHP Forked Package Workflow"
           style="background: #ff6600;"
           class="social--share--icon no-underline text-white hover:text-white rounded font-mono px-2 py-1"
        >Hacker News</a>

        <a href="https://www.linkedin.com/shareArticle?url=https://chasingcode.dev/blog/php-forked-package-workflow&title=My PHP Forked Package Workflow&summary=Documenting my workflow for dealing with forked PHP packages&source=https://chasingcode.dev"
           style="background: #4875B4;"
           class="social--share--icon no-underline text-white hover:text-white rounded font-mono px-2 py-1"
        >LinkedIn</a>

        <a href="mailto:?subject=My PHP Forked Package Workflow&body=https://chasingcode.dev/blog/php-forked-package-workflow"
           style="background: #444444;"
           class="social--share--icon no-underline text-white hover:text-white rounded font-mono px-2 py-1"
        >Email</a>
    </div>
</section>

<script>
    // @see https://www.bentasker.co.uk/posts/documentation/general/adding-a-share-on-mastodon-button-to-a-website.html
    doDocumentReady(enableMastodonShare);

    /* Generate a share link for the user's Mastodon domain */
    function mastodonShare(e) {

        // Get the source text
        const src = e.target.getAttribute("data-src");

        // Get the Mastodon domain
        const domain = prompt("Enter your Mastodon domain (enable browser pop-ups)", "mastodon.social");

        if (domain === "" || domain == null) {
            return;
        }

        // Build the URL
        const url = "https://" + domain + "/share?text=" + src;

        // Open a window on the share page
        window.open(url, '_blank');
    }

    function doDocumentReady(fn) {
        if (document.readyState === "complete" ||
            (document.readyState !== "loading" && !document.documentElement.doScroll)
        ) {
            fn();
        } else {
            document.addEventListener("DOMContentLoaded", fn);
        }
    }

    function enableMastodonShare() {
        document.getElementById('mastodon-share').addEventListener('click', mastodonShare);
    }
</script>        </div>

        <section id="mastodon-webmention">
    <mastodon-webmention page-url="https://chasingcode.dev/blog/php-forked-package-workflow" mastodon-toot-url=""></mastodon-webmention>
</section>

        

        <nav class="flex justify-between text-sm md:text-base my-4 sm:mb-0">
            <div>
                                    <a href="https://chasingcode.dev/blog/dynamic-svelte-component-router-pattern" class="no-underline" title="Older Post: The Dynamic Svelte Component Router Pattern">
                        &LeftArrow; The Dynamic Svelte Component Router Pattern
                    </a>
                            </div>

            <div>
                                    <a href="https://chasingcode.dev/blog/fix-php-environment-m1-mac" class="no-underline" title="Newer Post: How to restore a corrupted PHP environment on M1 Mac">
                        How to restore a corrupted PHP environment on M1 Mac &RightArrow;
                    </a>
                            </div>
        </nav>
    </article>
        </main>

        <footer class="flex flex-col gap-4 max-w-2xl m-8 sm:mx-auto text-center">
    <div class="w-full flex flex-row justify-center gap-4">
        <a href="/blog/feed.atom" class="group w-full flex flex-col items-center justify-center gap-2">
            <span class="group-hover:text-teal-400">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12.75 19.5v-.75a7.5 7.5 0 0 0-7.5-7.5H4.5m0-6.75h.75c7.87 0 14.25 6.38 14.25 14.25v.75M6 18.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z" />
                </svg>
            </span>
            <span class="group-hover:text-teal-400">RSS</span>
        </a>

        <a href="https://indieweb.social/@brbcoding" class="group w-full flex flex-col items-center justify-center gap-2">
            <span class="group-hover:text-teal-400">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                  <path d="M11.19 12.195c2.016-.24 3.77-1.475 3.99-2.603.348-1.778.32-4.339.32-4.339 0-3.47-2.286-4.488-2.286-4.488C12.062.238 10.083.017 8.027 0h-.05C5.92.017 3.942.238 2.79.765c0 0-2.285 1.017-2.285 4.488l-.002.662c-.004.64-.007 1.35.011 2.091.083 3.394.626 6.74 3.78 7.57 1.454.383 2.703.463 3.709.408 1.823-.1 2.847-.647 2.847-.647l-.06-1.317s-1.303.41-2.767.36c-1.45-.05-2.98-.156-3.215-1.928a4 4 0 0 1-.033-.496s1.424.346 3.228.428c1.103.05 2.137-.064 3.188-.189zm1.613-2.47H11.13v-4.08c0-.859-.364-1.295-1.091-1.295-.804 0-1.207.517-1.207 1.541v2.233H7.168V5.89c0-1.024-.403-1.541-1.207-1.541-.727 0-1.091.436-1.091 1.296v4.079H3.197V5.522q0-1.288.66-2.046c.456-.505 1.052-.764 1.793-.764.856 0 1.504.328 1.933.983L8 4.39l.417-.695c.429-.655 1.077-.983 1.934-.983.74 0 1.336.259 1.791.764q.662.757.661 2.046z"/>
                </svg>
            </span>
            <span class="group-hover:text-teal-400">Mastodon</span>
        </a>

        <a href="https://twitter.com/brbcoding" class="group w-full flex flex-col items-center justify-center gap-2">
            <span class="group-hover:text-teal-400">
                <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="feather feather-twitter"
>
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
</svg>
            </span>
            <span class="group-hover:text-teal-400">Twitter</span>
        </a>

        <a href="https://github.com/breadthe" class="group w-full flex flex-col items-center justify-center gap-2">
            <span class="group-hover:text-teal-400">
                <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="feather feather-github"
>
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
            </span>
            <span class="group-hover:text-teal-400">Github</span>
        </a>
    </div>
    <small class="italic opacity-60">
        2018-2024 🦄&nbsp; All content & opinions my own
    </small>
</footer>

        <script src="/assets/build/js/main.js?id=e27301064934efeda72c2d9e59dcaac9" async></script>

        <script>
    const navMenu = {
        toggle() {
            const menu = document.getElementById('js-nav-menu');
            menu.classList.toggle('hidden');
            menu.classList.toggle('lg:block');
            document.getElementById('js-nav-menu-hide').classList.toggle('hidden');
            document.getElementById('js-nav-menu-show').classList.toggle('hidden');
        },
    }
</script>
    </body>
</html>
